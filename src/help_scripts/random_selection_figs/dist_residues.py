import seaborn as sns
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

wd="/data/jzr5814/sourmash_dnds_estimation/tests/test/create_sequence_using_NG_assumption/0.01"
protein_sequence = "VGSLCEATVMPCRRSNGQYASAACVIITLCRPPVATRDGLRRVRVYYCISFYCGDFEDFQVSLSKPATAVPPRTEASQELSTPKCIVAHRSQQCGTSDRLELEAGARRFRSSVVNKQAVGARAHAWRQVNPQPANLPVARLKLASKSSSLFHRGEAETVATIPVLRALSGASGNAGQGLYSVCTHPTWQPSGYRSSGSPPNAGLSRVSVSAPRSDKDNTDESHGTPAKSELLQSGSFDSCWRENIGGLLTKGYMLLNLAGSRPSASRTEGLCYTMDRTHLETVNQTGQIRVREAHAISNIALATNTTTYNATSNPSTEGQILKELRTELEPNFGRLPTNKRRVGRHGQYAVLAYGPRSGIRLLHCAHEALTDRVARLRAPNPRRRALSIALNREKADSLVSGPTTPESPGTCCALSSMLQCHARTTSANIYQAIDRHCYKPDCWTSTDPTSEIKYHTSHFFHGITVCYIHLIEIAQTAGNTSTRGPAAMGPLDRITAGDSILRDMCSSSLSTLATAVRGVAFARYSLHSLVFTVIGTLGLSMKKADNSSWCRPYAQIEAVELDGAIWLRRSCVIFKAIYYPTQTRTLGERVRASSWCWVSLVYSLGLRRLRLAIIRGMMKGNRRNIMQNSHRTCTATTVYYCTQPGVNILACKSPQRYAEPTPDLVTIHLKPVLSSPCRFPNSHGRLVRPQCKIGLNNRGRNKLPTHSTVDVHVPCTTMLFHAVYLFALTVTGTWALVFHMIHALYLNLMTPPLWETPRKLEPIHLPLCKVRSNVKEYGQMFSAKQRLTPRTHSSHHERSSSSRLIRFVMHVCPIERSLKNPQVAGGPMTTRQGTENSEGGANLSILTRQAKLSLTAAVVRACSPGYANHLTLGTQGRLVEGSYPTETNTGLHSPFVAITNLRLPPQCRVEAWAASRGEWNLLLLGLSLGLCCRGIGAEAQTPSRSRVSEAERIYVIVPRTRRVLSFLRLASTDETILNDCSVFWSGIARRVRYHMAIQPITSLDGSKRRRTLKVAAVLSGDSARGTTHILNSSASLVAMAVPRRAPIKPFRRAQTLCWLPDLGLPHLIPTSMKQRKLCYFMAIAIAPIQAYAILYADIRKRRVRNAILVFFRTEKKDSLHSLLRGIRTFRLGSLDKSQLFFDLTRLMHVGIFPQGPVLGWSLRGICSVEICKPISSATVQTVRAHGCMGSDIRPLTWGTVATNPDQLMKFGTRITRTDTPIDCYCKKASRTLTFTKWLHGEPSIAMRNMPWQVLYRYHKSMRDQNKRIILNRRGISKVPRENAARGRLSSGQVQTCGDCRSAKQVDLMHHGMRKYYVGQNARHTARTARTQTGPRHEVGILHLSNAAVKLLALYIPIRRVQAAQSYKHSDIFQMSPIPSRFDYYSTQSWNSRRRLQQRVVPSFLMSTQKIVSTVRWTGFAGHEPVLHGSNPRDYSIPNRPLPHKIMLVSEQFDYMISLHGPVLHRYVPLWSNLSSSAVVNGSGVILAAIPAPNNTSTLIFGSFLLSPSGKYEDRVPLPINVVHRPLGGAMTVSPSLYYRFCDNVRTSYRAVPILTTKQTGYKAGKINSFTVIKTHESYHHLKLENTQGADKAVLWACLYNEGADSGYSSAQLRRQTKDSRKPPVNAIRKKSLYRSPTITRTGGCGAIAAITLAELHQIQLTARSSLGWVSRHLGTDTRFRTIVGEVRASSQRSLADMQSAIGARRLSSCSENREKGVPRRSRSMPEVNITRRYIVKKRIPPWIKTAHLAKVSPPAGRQSFSHNQCTSSRESQNAPVTLGVETRGLRIRDRRRHTVCTMWITPLLCLEWTSFIEQTFRISYRCIDCRSLFRSSSRKDSFSLIVAHPSNKSRILSLKMLRRIAYPRGGPVSKHYVVDHTAAIWNLRICHFLQEIFSAQITAEVNLGYDARCSRSAVLIGSRSSGFARRPDYQVPPRRENAETKVAYWKLPDHVFLPHVVKEGHCGFLDNRNGLQLSPRSFKGWRYSNLDRYWTRAKLPPVLCGGRFYRQAHLSGMCEIPYGHTVYRSDFQRNLTGHNRSFYRSIRNGMKSEEIPSSANPDLRSLLIAYNALFYAMFPTVQLGGLDQLGPYILLSCPWSHSCCYLGRKHVTTFVTNTNGRVRAPSAYTSSLTTHVDDVIREHAAKKSPMQSAYTNPPRWKNIAMRDPWHSKIGSTYEQSYPQFIVRAAALAPRSNGISQTGQMPYGFDSVPARPMLHEMLPNWHNSLDMACHVPDCPLNTLGRALLSGPESKPYYGVFHRMRKRTSSGIQGRAKAILVDGQYKRSRSTLDSRKPCVKSGLAFQMLLVAAQPNRWLRMTMYSLLTDVTGASASNSEKNNTKRNCVVSDLSAWRHVVPSLLSSWTNTRCARPGVQLEMGHAEFWSAYGPTIGLRESSITADSSSRSERTVSHFQIKLKLAVMLCAFRFSSRLSSTGRGIFLCPPTTECQRSSHVSLPGLSFRGPFEPFEKTRFPWSSSGGFSRACQASRRLQRTSISCGNVVFTLNVPVHPVRRWEKPCGYNFLASPRCPKLAHCVDKPSERSGWTPTWTFQREIYFCQTLDRPDQARFPWLVNFRFFFTGVGQYHKARINATMGLSANFAAWFTVAVLDYQQKSEANSHDGQIRAHGVTGRLQNGVPSLCPVVVAGLNGVSRRMIVDISGLSFTGHLLFGSHIQCLYTCWRSMLGRRNVAHEVAGCDIRKISPRGTTRSWAVQSCDVQIGWPFDAVLRKVRQPLKHATCILSLGWARLMLDRSNGNIVPLSPKPRWLSNCQFTDWWKPILNAPVSRIRRTKIIQVSSSDTQLTDEYGDLGPTTCIYQVKRTPLSICLWSLLSELFHCFRKRSPIELFRMPTIAIKGIKPMFSFITQCNDFNFGWKPRVHDSPMNSRVGPEQCRRKTQPRRTRTEQDLVVASVIAGCGDSRSEAIYRGSPSLSHLAHSSCALLYHTLTAKPNARPATRPTPAGMYRSSKSSDRDQAWMTGAQVSRDIVTLWFHSVMECGTFPLPFKAAICSDSVVAKVLRSWSSICTKVARSLSNANIRTVCYEDNDREDQVGWGTGPEVCSAIPPGPYHRGNWIASGSGDVHHNENTAVTHNGRRHWLSKRLASTKRIIKFPTVNLRPSPVKAEYVCQNTDCALSYCTTIYTFCPTCLGSIIQAHGMTLLTE"
residues = [char for char in protein_sequence]

residue_counts = {}
for residue in residues:
    residue_counts[residue] = residue_counts.get(residue, 0) + 1
sorted_residues = sorted(residue_counts.keys(), key=lambda x: residue_counts[x], reverse=True)


plt.bar(sorted_residues, [residue_counts[residue] for residue in sorted_residues], color='blue')
plt.tight_layout()
plt.xlabel('Residues')
#plt.subplots_adjust(bottom=0.1)
plt.xticks(rotation=90, ha='right')
plt.tick_params(axis='x', which='major', labelsize=10)

plt.ylabel('Frequency')
plt.title('negative_0.01 Reference Residue Distribution')
plt.show()
plt.savefig(f'{wd}/negative_0.01_ref_residue_dist.png',bbox_inches='tight')
