import seaborn as sns
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

wd="/data/jzr5814/sourmash_dnds_estimation/tests/test/create_sequence_using_NG_assumption/0.01"

def sequence_to_codons(nucleotide_sequence):
    if len(nucleotide_sequence) % 3 != 0:
        raise ValueError("Nucleotide sequence length must be divisible by 3 to form codons.")
    return [nucleotide_sequence[i:i+3] for i in range(0, len(nucleotide_sequence), 3)]

def plot_sorted_stacked_codon_distribution(sequence1, sequence2):
    codons1 = sequence_to_codons(sequence1)
    codons2 = sequence_to_codons(sequence2)

    unique_codons = list(set(codons1 + codons2))

    # Count occurrences of each codon for each sequence
    counts1 = [codons1.count(codon) for codon in unique_codons]
    counts2 = [codons2.count(codon) for codon in unique_codons]

    # Sort by total counts
    total_counts = np.add(counts1, counts2)
    sorted_indices = np.argsort(total_counts)[::-1]
    unique_codons_sorted = [unique_codons[i] for i in sorted_indices]
    counts1_sorted = [counts1[i] for i in sorted_indices]
    counts2_sorted = [counts2[i] for i in sorted_indices]

    # Creating sorted stacked bar plot
    index = np.arange(len(unique_codons_sorted))
    plt.bar(index, counts1_sorted, label='Reference')
    plt.bar(index, counts2_sorted, bottom=counts1_sorted, label='negative_0.01_0')

    plt.xticks(index, unique_codons_sorted)
    plt.tight_layout()

    plt.xlabel('Codons')
    plt.ylabel('Frequency')
    plt.title('negative_0.01_0 Codon Distribution')    
    
    plt.xticks(rotation=90, ha='right')
    plt.tick_params(axis='x', which='major', labelsize=5)
    
    plt.legend()  # Show legend to distinguish between distributions
    
    plt.savefig(f'{wd}/negative_0.01_0_codon_stack_ref_comparison.png',bbox_inches='tight')

# Example usage with two distributions:
nucleotide_sequence_ref = "GTCGGCAGTCTCTGCGAGGCCACTGTAATGCCGTGTAGACGGTCCAATGGCCAGTACGCATCCGCCGCTTGTGTGATCATAACGTTATGTCGGCCACCCGTGGCTACCAGAGACGGTCTTAGAAGGGTGAGGGTGTACTACTGCATCTCGTTTTATTGTGGGGATTTTGAGGATTTTCAAGTAAGCTTATCGAAACCAGCGACCGCTGTTCCTCCTCGAACCGAGGCATCCCAAGAATTGTCGACTCCAAAGTGTATCGTTGCGCATCGTTCTCAACAATGCGGGACCTCAGATCGCCTGGAGTTGGAGGCGGGCGCTCGACGTTTTAGGTCGAGTGTGGTCAACAAACAAGCCGTCGGAGCGCGCGCCCATGCCTGGAGACAAGTGAACCCTCAACCAGCGAATCTCCCCGTAGCAAGATTGAAATTGGCAAGTAAATCATCTTCTCTCTTTCATCGGGGTGAAGCTGAGACAGTAGCTACGATTCCTGTACTCCGCGCCCTTAGTGGCGCGAGTGGCAACGCCGGACAGGGCCTGTACAGCGTCTGTACACATCCAACATGGCAACCTAGTGGCTACCGAAGTTCGGGAAGCCCTCCTAACGCAGGGCTTAGTAGGGTATCAGTCTCGGCACCCCGATCGGACAAAGACAACACCGATGAGTCCCATGGAACGCCTGCAAAATCTGAGTTGCTTCAATCCGGGTCCTTTGATTCATGCTGGAGGGAAAACATTGGGGGGCTGCTTACCAAGGGGTACATGCTTCTCAATCTCGCGGGCAGCCGCCCCAGTGCCTCGCGGACCGAAGGGTTATGCTATACAATGGACAGAACACACTTAGAGACTGTAAACCAAACTGGCCAGATCCGTGTGCGGGAAGCTCACGCGATCTCGAATATTGCACTAGCCACTAATACAACGACATACAACGCAACATCGAACCCGTCTACCGAAGGCCAAATCCTCAAAGAACTACGGACAGAACTAGAGCCCAACTTTGGCCGATTACCAACGAACAAAAGACGAGTTGGCAGACACGGTCAGTATGCGGTGCTTGCCTATGGCCCGCGATCAGGCATAAGGTTGCTACACTGCGCCCATGAAGCCTTGACAGACCGTGTAGCACGCCTCAGAGCACCAAATCCGCGTCGTCGGGCTCTTTCGATTGCCCTGAACAGAGAAAAAGCAGACTCTCTTGTTTCCGGTCCTACGACTCCTGAGTCGCCTGGAACTTGTTGTGCGTTGTCTTCCATGCTTCAATGTCATGCACGAACAACGTCCGCTAACATTTATCAGGCTATAGACCGTCACTGCTACAAACCCGACTGCTGGACTTCGACTGACCCAACAAGCGAGATTAAGTACCATACATCCCACTTTTTCCATGGTATAACGGTGTGTTATATCCATCTTATTGAGATTGCCCAGACGGCCGGTAATACCTCTACTCGGGGACCCGCGGCAATGGGGCCGCTTGATAGAATAACAGCGGGTGACTCGATTCTACGTGACATGTGCTCGTCCTCGCTTTCGACATTAGCCACGGCCGTACGCGGCGTGGCATTCGCTCGGTACTCGTTACACAGCCTAGTTTTTACCGTTATTGGTACCTTGGGTCTGTCAATGAAAAAAGCGGATAATAGCAGTTGGTGCAGGCCCTACGCTCAGATCGAAGCGGTTGAGTTGGACGGCGCCATATGGCTGCGTCGCTCCTGTGTGATTTTCAAGGCGATATACTATCCAACACAGACTCGTACTCTCGGAGAGCGGGTACGAGCCTCGAGTTGGTGCTGGGTTAGTCTGGTATACTCACTCGGTTTGCGTCGACTAAGACTAGCGATCATCCGGGGGATGATGAAGGGGAATCGGCGCAATATCATGCAGAATTCCCACCGTACGTGCACTGCAACCACTGTGTACTACTGCACTCAACCGGGCGTAAATATCTTGGCTTGTAAGTCTCCACAGCGATATGCTGAACCTACCCCGGATCTTGTTACAATACATCTAAAACCTGTTTTGTCGTCCCCGTGTCGTTTTCCGAACAGTCATGGTAGATTGGTTCGCCCCCAGTGCAAGATCGGGCTTAACAACAGGGGGCGGAATAAGCTACCAACTCACTCCACTGTCGACGTCCATGTCCCTTGCACTACTATGCTCTTTCACGCCGTGTACTTATTCGCGTTAACAGTGACCGGCACTTGGGCATTGGTGTTCCATATGATACATGCTCTATATTTGAACCTGATGACACCCCCGCTTTGGGAGACTCCCAGGAAATTAGAACCAATCCATTTACCCCTTTGTAAGGTTCGAAGTAACGTAAAAGAGTATGGGCAGATGTTCTCGGCAAAGCAGCGGCTTACCCCACGTACGCACTCTAGTCACCACGAACGAAGTTCTTCGTCCCGGCTTATTCGCTTCGTAATGCACGTTTGTCCAATCGAGCGCTCCCTCAAGAATCCGCAGGTCGCGGGGGGACCCATGACTACCCGACAAGGGACAGAGAACTCAGAGGGAGGTGCAAATCTATCCATACTCACCCGGCAGGCGAAACTTTCTCTGACAGCCGCGGTGGTACGCGCGTGCAGTCCCGGTTATGCAAATCATCTGACCCTCGGTACCCAGGGACGCTTAGTCGAGGGGTCATATCCGACCGAAACTAATACTGGGCTGCACTCGCCGTTTGTTGCGATCACTAACTTACGTCTTCCCCCGCAGTGCAGGGTCGAGGCGTGGGCAGCCTCACGGGGGGAGTGGAACTTACTGCTCTTAGGGCTCAGTTTAGGCCTATGTTGTCGAGGAATAGGAGCGGAAGCCCAAACCCCAAGCCGAAGTCGGGTCTCGGAGGCGGAACGGATTTATGTTATAGTTCCACGAACTAGGCGTGTGCTGTCCTTTCTCCGGCTCGCGAGTACCGACGAAACGATTTTGAATGACTGCAGTGTATTTTGGTCGGGGATAGCTAGACGAGTGAGGTACCACATGGCGATCCAGCCCATCACTAGTTTGGATGGGTCAAAGAGGCGACGTACGCTCAAAGTTGCTGCTGTTCTCTCCGGTGACTCCGCTAGAGGTACGACGCATATACTTAATTCGAGTGCTAGCTTAGTGGCAATGGCAGTCCCCCGGCGAGCCCCGATCAAGCCTTTTCGCAGAGCACAAACCTTGTGCTGGCTGCCTGACCTAGGCCTCCCTCACCTTATCCCGACAAGCATGAAACAGCGTAAGTTATGCTATTTTATGGCCATTGCAATAGCCCCGATACAGGCGTACGCTATTTTATACGCCGACATCCGCAAAAGGCGGGTGCGCAATGCCATTTTAGTTTTTTTTCGCACGGAGAAGAAAGACTCCCTTCATTCACTGCTTCGTGGAATCCGGACCTTTCGCTTGGGATCTCTTGACAAATCACAGTTATTCTTCGACTTGACTAGACTAATGCACGTCGGTATATTTCCGCAAGGCCCTGTACTTGGGTGGAGCCTGAGGGGAATTTGCTCAGTCGAGATTTGCAAACCCATAAGTTCCGCAACTGTCCAGACAGTTCGTGCCCATGGTTGCATGGGATCAGACATAAGGCCTCTTACTTGGGGCACGGTTGCCACGAATCCAGACCAACTAATGAAATTCGGTACACGTATCACACGAACGGACACGCCGATTGACTGCTACTGTAAAAAAGCTAGCAGAACACTAACGTTTACAAAGTGGCTGCACGGCGAGCCAAGTATTGCCATGCGAAATATGCCGTGGCAGGTACTATATCGGTATCATAAGTCGATGCGGGATCAAAACAAGCGCATTATTTTAAACCGTCGCGGCATAAGTAAAGTGCCGCGCGAGAACGCTGCACGGGGCCGTCTCTCATCAGGCCAGGTACAAACCTGCGGGGATTGTAGGTCGGCCAAGCAAGTCGATTTGATGCACCATGGTATGCGAAAATACTACGTTGGACAAAACGCCAGGCATACTGCTCGCACGGCTCGGACCCAAACGGGGCCAAGGCATGAGGTAGGCATCCTGCATTTGTCAAACGCTGCGGTTAAGCTGTTAGCATTGTACATTCCTATAAGGCGGGTTCAAGCTGCGCAATCCTACAAACACAGTGACATTTTCCAGATGAGTCCCATACCGTCGCGTTTCGATTATTATAGCACACAGTCGTGGAATAGCCGCCGTCGTCTCCAACAGCGAGTCGTACCATCTTTTTTAATGAGTACTCAAAAGATCGTCTCTACAGTGCGCTGGACCGGCTTCGCGGGTCATGAGCCAGTCCTTCATGGGAGTAACCCCCGAGACTATTCTATCCCGAACCGTCCACTTCCTCATAAGATAATGCTTGTATCGGAGCAGTTTGATTATATGATCTCTTTGCACGGCCCGGTGCTGCACCGCTACGTCCCTCTTTGGAGCAATCTCTCGTCGTCTGCTGTGGTAAACGGATCCGGAGTGATATTAGCTGCCATACCTGCTCCGAACAATACTTCCACTCTAATATTCGGTTCCTTCTTACTAAGTCCCTCGGGGAAGTATGAGGATCGAGTCCCACTCCCCATCAATGTGGTCCACCGGCCGCTTGGCGGTGCCATGACTGTTAGCCCGTCTCTCTACTACAGGTTCTGTGATAACGTTCGAACTTCATACCGAGCGGTGCCGATTCTGACCACAAAGCAGACTGGTTATAAAGCGGGGAAAATTAACTCCTTTACGGTGATCAAAACACACGAGTCATACCACCATCTAAAATTGGAAAATACGCAGGGTGCCGACAAGGCAGTCCTATGGGCATGTCTCTACAATGAGGGCGCCGACTCCGGGTACTCGAGCGCCCAACTAAGGCGTCAAACAAAGGATTCGAGAAAACCCCCTGTTAATGCAATACGTAAAAAGAGTCTCTACCGATCCCCCACCATAACACGGACTGGGGGTTGCGGCGCAATCGCAGCGATTACTCTAGCCGAGCTCCATCAAATACAGCTGACTGCGAGATCATCCTTGGGGTGGGTCTCACGTCATCTGGGGACGGACACGCGTTTTCGTACCATTGTTGGGGAGGTAAGGGCATCATCCCAGCGGAGTCTCGCGGATATGCAAAGTGCGATCGGGGCGAGGCGATTAAGCTCCTGCTCAGAGAACCGTGAGAAGGGAGTTCCTAGACGCTCAAGGTCAATGCCTGAGGTTAATATCACACGCCGCTATATCGTTAAAAAGCGAATACCACCGTGGATTAAAACCGCTCACCTAGCGAAGGTGTCCCCCCCAGCGGGACGTCAAAGTTTCTCACATAACCAATGCACCTCCTCCCGAGAGTCGCAAAATGCCCCTGTTACGTTAGGAGTCGAAACGCGGGGGTTGCGCATACGAGACAGGAGGAGACACACGGTGTGCACTATGTGGATCACTCCCCTCCTGTGTCTCGAGTGGACTTCTTTCATCGAGCAGACCTTTCGCATCAGTTACCGTTGCATTGATTGCCGATCTTTGTTCCGTTCTTCATCGCGCAAGGACTCTTTCAGTTTGATTGTCGCACACCCTTCGAATAAAAGTCGGATACTATCATTGAAAATGCTAAGGAGAATAGCTTATCCACGAGGCGGTCCCGTTTCAAAGCACTATGTCGTCGATCATACTGCAGCAATATGGAACCTTCGCATCTGCCATTTCCTCCAGGAGATTTTCTCAGCCCAGATTACAGCCGAGGTCAATCTGGGTTATGACGCCAGGTGTTCACGAAGCGCTGTATTGATCGGTAGTAGAAGCTCTGGGTTCGCTCGGAGACCGGACTATCAAGTCCCACCTCGCAGAGAAAATGCAGAAACTAAGGTTGCTTATTGGAAACTCCCCGACCACGTCTTTCTGCCGCATGTCGTCAAAGAGGGACACTGCGGTTTTCTCGACAATCGCAATGGATTACAATTGTCGCCACGCTCTTTCAAAGGATGGAGGTATTCGAACCTAGACAGATATTGGACGCGAGCAAAATTACCGCCGGTACTCTGCGGCGGGCGTTTCTATAGACAGGCCCACCTTTCGGGAATGTGTGAGATCCCCTATGGACACACCGTTTACCGCTCAGACTTCCAGCGAAACTTGACAGGACACAATCGCTCTTTCTACAGGTCGATTAGAAACGGCATGAAGAGTGAGGAGATACCCTCGTCAGCAAACCCCGACCTGAGGTCTCTGTTGATAGCGTACAACGCGCTATTTTACGCGATGTTTCCAACCGTACAATTAGGCGGGTTAGACCAACTAGGTCCGTACATACTTCTCAGCTGCCCTTGGTCCCATAGTTGCTGTTACCTTGGGAGGAAGCACGTGACTACTTTCGTGACCAACACCAACGGACGGGTCAGGGCGCCTTCAGCATACACCAGTTCCCTTACTACCCATGTCGACGACGTCATCCGCGAACATGCTGCCAAAAAGTCCCCTATGCAATCCGCGTATACTAATCCACCGCGATGGAAGAACATAGCCATGAGAGACCCATGGCACTCCAAGATAGGCTCAACCTATGAGCAATCATACCCCCAATTTATTGTGAGAGCCGCTGCGCTTGCGCCACGAAGCAATGGAATCTCTCAAACTGGACAAATGCCCTACGGCTTTGATTCCGTCCCTGCCCGACCTATGCTCCATGAGATGTTGCCGAATTGGCATAACTCACTCGATATGGCATGTCATGTTCCGGATTGTCCACTAAATACCCTTGGTCGTGCTTTGTTATCTGGTCCTGAATCGAAGCCCTACTATGGTGTATTTCATAGAATGAGAAAGAGAACTAGCTCAGGCATACAAGGCCGTGCCAAAGCGATCCTCGTAGATGGACAATACAAACGATCAAGATCTACTTTGGATAGTCGAAAGCCCTGCGTCAAATCCGGGCTTGCGTTTCAGATGTTACTGGTTGCAGCGCAGCCTAATAGATGGTTGCGTATGACAATGTATAGCCTTCTAACCGATGTGACAGGTGCTTCGGCGAGTAACTCGGAAAAAAATAACACCAAGAGAAACTGTGTTGTAAGCGACCTATCAGCATGGAGGCATGTGGTCCCGTCCTTGCTCTCAAGTTGGACGAATACTCGATGTGCGAGACCGGGTGTACAACTAGAGATGGGCCACGCGGAGTTTTGGTCAGCGTACGGTCCTACAATTGGGCTTCGAGAATCATCTATCACTGCGGATTCCAGTTCACGTTCCGAGCGTACCGTTTCGCATTTTCAAATTAAATTGAAGCTTGCAGTGATGCTTTGTGCATTTCGATTTTCATCCAGACTATCGTCGACAGGACGGGGAATCTTTCTGTGTCCCCCGACAACAGAGTGTCAACGATCAAGTCACGTGTCACTTCCGGGACTTAGCTTCCGTGGCCCATTCGAACCTTTCGAGAAGACAAGGTTTCCATGGAGCTCAAGTGGAGGGTTTTCGCGGGCGTGTCAAGCGTCCCGTCGTCTACAGCGGACCTCCATTTCGTGTGGCAATGTCGTATTCACGCTTAACGTGCCAGTTCATCCTGTGCGAAGGTGGGAGAAACCGTGTGGGTACAACTTCCTCGCCTCTCCCCGATGTCCAAAGCTGGCTCATTGTGTGGACAAACCCTCGGAGAGATCTGGCTGGACACCGACTTGGACATTTCAACGCGAGATCTACTTCTGTCAAACGCTGGACCGACCCGATCAGGCACGCTTCCCCTGGTTAGTTAACTTTCGCTTTTTCTTCACAGGCGTGGGGCAGTACCATAAAGCCCGCATTAATGCAACTATGGGTTTAAGTGCAAACTTCGCCGCATGGTTCACCGTTGCGGTGCTAGACTACCAACAGAAGTCTGAGGCTAACAGCCACGACGGACAAATTCGCGCCCATGGAGTAACAGGCCGTCTCCAGAATGGCGTACCATCGCTTTGTCCTGTAGTGGTCGCTGGACTGAACGGTGTGTCGAGAAGAATGATAGTTGACATAAGTGGACTGAGTTTCACGGGACACCTCTTATTCGGCTCCCACATCCAGTGCTTGTACACTTGCTGGCGTAGTATGCTGGGGCGTCGGAATGTTGCGCACGAAGTAGCTGGCTGCGACATACGTAAAATATCGCCACGGGGCACAACGCGGTCTTGGGCAGTCCAGAGCTGCGACGTTCAGATTGGATGGCCGTTTGACGCGGTTCTGCGCAAAGTGCGACAGCCACTGAAACATGCCACATGTATTCTATCCCTCGGATGGGCAAGGCTAATGCTAGACCGATCGAACGGCAATATTGTACCATTGAGTCCTAAGCCACGCTGGCTGTCGAATTGCCAGTTCACAGATTGGTGGAAACCAATACTGAATGCACCGGTATCTAGGATCAGGAGGACTAAGATTATCCAGGTCTCATCGTCGGATACGCAATTAACAGATGAATATGGCGATTTAGGTCCGACCACGTGTATTTACCAAGTTAAGAGAACCCCTCTATCCATTTGTCTTTGGTCTTTACTGTCAGAGTTATTCCACTGTTTTAGGAAGCGTAGCCCCATAGAACTTTTTCGCATGCCTACCATCGCTATCAAAGGCATAAAACCGATGTTTAGCTTCATAACACAGTGTAATGACTTTAACTTCGGGTGGAAGCCAAGAGTTCATGACTCGCCTATGAACTCTCGCGTCGGACCTGAACAGTGCCGCCGCAAGACGCAGCCTAGGCGCACCAGGACCGAACAGGACTTAGTAGTCGCTTCTGTGATCGCCGGATGTGGCGATTCTAGGAGTGAAGCAATATACCGCGGATCGCCTTCGCTGAGTCACCTTGCGCATTCGAGTTGTGCTCTACTTTATCACACTTTGACGGCTAAACCCAACGCGCGGCCAGCAACGCGCCCTACGCCGGCCGGCATGTATCGCAGTTCTAAGTCCTCGGATCGCGATCAGGCATGGATGACTGGCGCACAAGTCTCGCGTGATATCGTCACACTGTGGTTTCACTCAGTGATGGAGTGCGGAACTTTTCCCCTTCCATTTAAGGCAGCAATATGCAGCGATTCCGTAGTGGCTAAAGTACTGCGTAGTTGGTCCTCTATATGTACCAAGGTCGCCAGAAGTTTATCAAACGCAAACATAAGGACGGTATGCTACGAGGACAATGATCGGGAAGACCAAGTAGGGTGGGGGACTGGGCCTGAAGTATGCTCCGCCATTCCGCCAGGCCCTTACCATAGAGGTAACTGGATCGCAAGTGGCTCAGGGGATGTACATCATAATGAGAATACAGCCGTGACTCATAATGGTCGCAGACATTGGTTATCAAAACGGTTGGCGAGTACCAAACGGATCATCAAGTTTCCCACAGTTAACTTACGTCCGTCCCCCGTTAAGGCAGAATATGTTTGCCAAAACACCGATTGTGCACTGAGCTACTGTACGACTATCTACACTTTCTGTCCGACATGTTTGGGAAGCATTATACAAGCACACGGCATGACCCTATTAACAGAG"
nucleotide_sequence = "GTCGGCAGTCTCTGCGAGGCCACTGTAATGCCGTGTAGACGGTCCAATGGCCAGTACGCATCCGCCGCTTGTGTGATCATAACGTTATGTCGGCCACCCGTGGCTACCAGAGACGGTCTTAGAAGGGTGAGGGTGTACTACTGCATCTCGTTTTATTGTGGGGATTTTGAGGATTTTCAAGTAAGCTTATCGAAACCAGCGACCGCTGTTCCTCCTCGAACCGAGGCATCCCAAGAATTGTCGACTCCAAAGTGTATCGTTGCGCATCGTTCTCAACAATGTGGGACCTCAGATCGCCTGGAGTTGGAGGCGGGCGCTCGACGTTTTAGGTCGAGTGTGGTCAACAAACAAGCCGTCGGAGCGCGCGCCCATGCCTGGAGACAAGTGAACCCTCAACGAGCGAATCTCCCCGTTGCAAGATTGAAATTTGCAAGTAAATCATCTTCTCTCTTTCATCGGGGTGAAGCTGAGACAGTAGCTACGATTCCTGTACTCCGCGCCCTTAGTGGCGCGAGTGGCAACGCCGGACAGGGCCTGGACAGCGTCTGTACACATCCAACATGGCAACCTAGTGGCTACCGAAGTTCGGGAAGCCCTCCTAACGCAGGGCTTAGTAGGGTATCAGTCTCGGCACCCCGATCGGACAAAGACAACACCGATGAGTCCCATGGAACGCCCGCAAAATCTGAGTTGCTTCAATCCGGGTCCTTTGATTCATGCTGGAGGGAAAACATTGGGGGGCTGCTTACCAAGGGGTACATGCTTCTCAATCTCGCGGGCAGCCGCCCCAGTGCCTCGCGGACCGAAGGGTTATGCTATACAATGGACAGAACACACTTAGAGACTGTAAACCAAACTGGCCAGATCCGTGTGCGGGAAGCTCACGCGATCTCGAATATTGCACTAGCCACTAATACAACGACATACAACGCAACATCGAACCCGTCTACCGAAGGCCAAATCCTCAAAGAACTACGGACAGAACGAGAGCCCAACTTTGGCCGATTACCAACGAACAAACGACGAGTTGGCAGACACGGTCAGTATGCGGTGCTTGCCTATGGCCCGCGATCAGGCATAAGGTTGCTACACTGCGCCCATGAAGCCTTGACAGACCGTGTAGCACGCCTGAGAGCACCAAATCCGCGTCGTCGGGCTCTTTCGATTGCCCTGAACAGAGAAAAAGCAGACTCTCTTGTTTCCGGTCCTACGACTCCTGAGTCGCCTGGTACTTGTTGTGCGTTGTCTTCCATGCTTCAATGTCTTGCACGAACAACGTCCGCTAACATTTATCAGGCTATAGACCGTCACTGCTACAAACCCGACTGCTGGACTTCGACTGATCCAACAAGCGAGATTAAGTACCATACATCCCACTTTTTCCATGGTATAACGGTGTGTTATATCCATCTTATTGAGATTGCCCAGACGGCCGGTAATACCTCTACTCGGGGACCCGCGGCAATGGGGCCGCTTGATAGAATAACAGCGGGTGACTCGATTCTACGTGACATGTGCTCGTCCTCGCTTTCGACATTAGCCACGGCCGTACGCGGCGTGGCATTCGCTCGGTACTCGTTACACAGTCTAGTTTTTACCGTTATTGGTACCTTGGGTCTGTCAATGAAAAAAGCGGATAATAGCAGTTGGTGCAGGCCCTACGCTCAGATCGAAGCGGTTGAGTTGGACGGCGCCATATGGCTGCGTCGCTCCTGTGTGATTTTCAAGGCGATATACTATCCAACACAGACTCGTACTCTCGGAGAGCGGGTACGAGCCTCGAGTTGGTGCTGGGTTAGTCTGGTATACTCACTCGGTTTGCGTCGACTAAGACTAGCGATCATCCGGGGGATGATGAACGGGAACCGGCGCAATATCATGCAGAATTCCCACCGTACGTGCACTGCAACCACTGTATACTACTGCACTCAACCGGGCGTAAAGATCTTGGCTTGTAAGTCTCCACAGCGATATGCTGAACCTACCCCGGATCTTGTTACAATACATCTAAAACCTGTTTTGTCGTCCCCGTGTCGTTTTCCGAACAGTCATGGTAGATTGGTTCGCCCTCAGTGCAAGATCGGGCTTAACAACAGGGGGCGGAATAAGCTACCAACTCACTCCACTGTCGACGTCCATGTCCCTTGCACTACTATGCTCTTTCACGCCGTGTACTTATTCGCGTTAACAGTGACCGGCACTTGGGCATTGGTGTTCCATATGATACATGCTCTATATTTGAACCTGATGACACCCCCGCTTTGGGAGACTCCCAGGAAATTAGAACCTATCCATTTACCCCTTTGTAAGGTTCGAAGTAACGTAAAAGAGTATGGGCAGATGTTCTCGGCAAAGCAGCGGCTTACCCCACGTACGCACTCTAGTCACCACGAACGAAGTTCTTCGTCCCGGCTTATTCGCTTCGTAATGCACGTTTGTCCAATCGAGCGCTCCCTCAAGAATCCGCAGGTCGCGGGGGGACCCATGACTACCCGACAAGGGACAGAGAACTCAGAGGGAGGTGCAAATCTATCCATACTCACCCGGCAGGCGAAACTTTCTCTGACAGCCGCGGTGGTACGCGCGTGCAGTCCCGGTTATGCAAATCATCTGACCCTCGGTACCCAGGGACGCTTAGTCGAGGGGTCATATCCGACCGAAACTAATACTGGGCTGCACTCGCCGTTTGTTGCGATCACTAACTTACGTCTTCCCCCGCAGTGCAGGGTCGAGGCGTGGGCAGCCTCACGGGGGGAGTGGAACTTACTGCTCTTAGGGCTCAGTTTAGGCCTATGTTGTCGAGGAATAGGAGCGGAAGCCCAAACCCCAAGCCGAAGTCGGGTCTCGGAGGCGGAACGGATTTATGTTATAGTTCCACGTACTAGGCGTGTGCTGTCCTATCTCCGGCTCGCGAGTACCGACGAAACGATTTTGAATGACTGCAGTGTATTTTGGTCGGGGATAGCTAGACGAGTGAGGTACCACATGGCGATCCAGCCCATCACTAGTTTGGATGGGTCAAAGAGGCGACGTACGCTCAAAGTTGCTGCTGTTCTCTCCGGTGACTCCGCTAGAGGTACGACGCATATACTTAATTCGAGTGCTAGCTTAGTGGCAATGGCAGTCCCCCGGCGAGCCCCGATCAAGCCTTTTCGCAGAGCACAAACCTTGTGCTGGCTGCCTGACCTAGGCCTCCCTCACCTTATCCCGACAAGCATGAAACAGCGTAAGTTATGCTATTTTATGGCCATTGCAATAGCCCCGATACAGGCGTACGCTATTTTATACGCCGACATCCGCAAAAGGCGGGTGCGCAATGCCATTTTAGTTTTTTTTCGCACGGAGAAGAAAGACTCCCTTCATTCACTGCTTCGTGGAATCCGGACCTTTCGCTTGGGATCTCTTGACAAATCACAGTTATTCTTCGACTTGACTAGACTAATGCACGTCGGTATATTTCCGCAAGGCCCTGTACTTGGGTGGAGCCTGAGGGGAATTTGCTCAGTCGAGATTTGCAAACCCATAAGTTCCGCAACTGTCCAGACAGTTCGTGCCCATGGTTGCATGGGATCAGACATAAGGCCTCTTACTTGGGGCACGGTTGCCACGAATCCAGACCAACTAATGAAATTCGGTACACGTATCACACGAACGGACACGCCGATTGACTGCTACTGTAAAAAAGCTAGCAGAACACTAACGTTTACAAAGTGGCCGCACGGCGAGCCAAGTATTGCCATGCGAAATATGCCGTGGCAGGTACTATATCGGTATCATAAGTCGATGCGGGATCAAAACAAGCGCATTATTTTAAACCGTCGCGGCATAAGTAAAGTGCCGCGCGAGAACGCTGCACGGGGCCGTCTCTCATCAGGCCAGGTACAAACCTGCGGGGATTGTAGGTCGGCGAAGCAAGTCGATTTGATGCACCATGGTATGCGAAAATACTACGTTGGACAAAACGCCAGGCATACTGCTCGCACGGCTCGGACCCAAACGGGGCCAAGGCATGAGGTAGGCATCCTGCATTTGTCAAACGCTGCGGTTAAGCTTTTAGCATTGTACATTCCTATAAGGCGGGTTCAAGCTGCGCAATCCTACAAACACAGTGACATTTTCCAGATGAGTCCCATACCGTCGCGTTTCGATTATTATAGCACACAGTCGTGGAATAGCCGCCGTCGTCTCCAACAGCGAGTCGTACCATCTTTTTTAATGAGTACTCAAAAGATCGTCTCTACAGTTCGCTGGACCGGCTTCGCGGGTCATGAGCCAGTCCTTCATGGGAGTAACCCCCGAGACTATTCTATCCCGAACCGTCCACTTCCTCATAAGATAATGCTTGTATCGGAGCAGTTTGATTATATGATCTCTTTGCACGGCCCGGTGCTGCACCGCTACGTCCCTCTTTGGAGCAATCTCTCGTCGTCTGCTGTGGTAAACGGATCCGGAGTGATATTAGCTGCCATACCTGCTCCGAACAATACTTCCACTCTAATATTCGGTTCCTTCTTACTAAGTCCCTCGGGGAAGTATGAGGATCGAGTCCCACTCCCCATCAATGTGGTCCACCGGCCGCTTGGCGGTGCCATGACTGTTAGCCCGTCTCTCTACTACAGGTTCTGTGATAACGTTCGAACTTCATACCGAGCGGTGCCGATTCTGACCACAAAGCAGACTGGTTATAAAGCGGGGAAAATTAACTCCTTTACGGTGATCAAAACACACGAGTCATACCACCATCTAAAATTGGAAAATACGCAGGGTGCCGACAAGGCAGTCCTATGGGCATGTCTCTACAACGAGGGCGCCGACTCCGGGTACTCGAGCGCCCAACTAAGGCGTCAAACAAAGGATTCGAGAAAACCCCCTGTTAAGGCAATACGTAAAAAGAGTCTCTACCGATCCCCCACCATAACACGGACTGGGGGTTGCGGCGCTATCGCAGCGATTACTCTAGCCGAGCTCCATCAAATACAGCTGACTGCGAGATCATCCTTGGGGTGGGTCTCACGTCATCTGGGGACGGACACGCGTTTTCGTACCATTGTTGGGGACGTAAGGGCATCATCCCAGCGGAGTCTCGCGGATATGCAAAGTGCGATCGGGGCGAGGCGACTAAGCTCCTGCTCAGAGAACCGTGAGAAGGGAGTTCCTAGACGCTCAAGGTCAATGCCTGAGGTTAATATCACACGCCGCTATATCGTTAAAAAGCGAATACCACCGTGGATTAAAACCGCTCACCTAGCGAAGGTGTCCCCCCCAGCGGGACGTCAAAGTTTCTCACATAACCAATGCACCTCCTCCCGAGAGTCGCAAAATGCCCCTGTTACGTTAGGAGTCGAAACGCGGGGGTTGCGCATACGAGACAGGAGGAGACACACGGTATGCACTATGTGGATCACTCCCCTCCTGTGTCTCGAGTGGACTTCTTTCATCGAGCAGACCTTTCGCATCAGTTACCGTTGCATTGATTGCCGATCTTTGTTCCGTTCTTCATCGCGCAAGGACTCTGTCAGTTTGATTGTCGCACACCCTTCGAATAAAAGTCGGATACTATCATTGAAAATGCTAAGGAGAATAGCTTATCCACGAGGTGGTCCCGTTTCAAAGCACTATGTCGTCGATCATACTGCAGCAATATGGAACCTTCGCATCTGCCATTTCCTCCAGGAGATTTTCTCAGCCCAGATTACAGCCGAGGTCAATCTGGGTTATGACGCCAGGTGTTCACGAAGCGCTGTATTGATCGGTAGTAGAAGCTCTGGGTTCGCTCGGAGACCGGACTATCAAGTCCCACCTCGCAGAGAAAATGCAGAAACTAAGGTTGCTTATTGGAAACTCCCCGACCACGTCTTTCTGCCGCATGTCGTCAAAGAGGAACACTGCGGTTTTCTCGACAATCGCAATGGATTACAATTGTCGCCACGCTCTTTCAAAGGATTGAGGTATTCGAACCTAGACAGATATTGGACGCGAGCAAAATTACCGCCGGTACTCTGCGGCGGGCGTTTCTATAGACAGGCCCACCTTTCGGGGATGTGTGAGATCCCCTATGGACACACCGTTTACCGCTCAGACTTCCAGCGAAACTTGACAGGACACAATCGCTCTTTCTACAGGTCGATTAGAAACGGCATGAAGAGTGAGGAGATACCCTCGTCAGCAAACCCCGACCTGAGGTCTCTGTTGATAGCGTACAACGCGCTATTTTACGCGATGTTTCCAACCGTACAATTAGGCGGGTTAGACCAACTAGGTCCGTACATACTTCTCAGCTGCCCTTGGTCCCATAGTTGCTGTTACCTTGGGAGGAAGCACGTGACTACTTTCGGGACCAACACCAACGGACGGGTCAGGGCGCCTTCAGCATACACCAGTTCCCTTACTACCCATGTCGACGACGTCATCCGCGAACATGCTGCCAAAAAGTCCCCTATGCAATCCGCGTATACTAATCCACCGCGATGGAAGAACATAGCCATGAGAGACCCATGGCACTCCAAGATAGGCTCAACCTATGAGCAATCATACCCCCAATTTATTGTGAGAGCCGCTGCGCTTGCGCCACGAAGCAATGGAATCTCTCAAACTGGACAAATGCCCTACGGCTTTGATTCCGTCCCTGCCCGTCCTATGCTCCATGAGATGTTGCCGAATTGGCATAACTCACTCGATATGGCATGTCATGTTCCGGATTGTCCACTAAATACCCTTGGTCGTGCTTTGTTATCTGGTCCTGAATCGAAGCCCTACTATGGTGTATTTCATAGAATGAGAAAGAGAACTAGCTCAGGCATACAAGGCCGTGCCAAAGCGATCCTCGTAGATGGACAATACAAACGATCAAGATCTACTTTGGATAGTCGAAAGCCCTGCGTCAAATCCGGGCTTGCGTTTCAGATGTTACTGGTTGCAGCGCAGCCTAATAGATGGTTGCGTATGACAATGTATAGCCTTCTAACCGATGTGACAGGTGCTTCGGCGAGTAACTCGGAAAAAAATAACACCAAGAGAAACTGTGTTGTAAGCGACCTATCAGCATGGAGGCATGTGGTCCCGTCCTTGCTCTCAAGTTGGACGAACACTCGATGTGCGAGACCGGGTGTACAACTAGAGATGGGCCACGCGGAGTTTTGGTCAGCGTACGGTCCTACAATTGGGCTTCGAGAATCATCTATCACTGCGGATTCCAGTTCACGTTCCGAGCGTACCGGTTCGCATTTTCAAATTAAATTGAAGCTTGCAGTGATGCTTTGTGCATTTCGATTTTCATCCAGACTATCGTCGACAGGACGGGGAATCTTTCTGTGTCCCCCGACAACAGAGTGTCAACGATCAAGTCACGTGTCACTTCCGGGACTTAGCTTCCGTGGCCCATTCGAACCGTTCGAGAAGACAAGGTTTCCATGGAGCTCAAGTGGAGGGTTTTCGCGGGCGTGTCAAGCGTCCCGTCGTCTACAGCGGACCTCCATTTCGTGTGGCAATGTCGTATTCGCGCTTAACGTGCCAGTTCATCCTGTGCGAGGGTGGGAGAAACCGTGTGGGTACAACTTCCTCGCCTCTCCCCGATGTCCAAAGCTGGCTCATTGTGTGGGCAAACCCTCGGAGAGATCTGGCTGGACACCGACTTGGACATTTCAACGCGAGATCTACTTCTGTCAAACGCTGGACCGACCCGATCAGGCACGCTTCCCCTGGTTAGTTAACTTTCGCTTTTTCTTCACAGGCGTGGGGCAGTACCATAAAGCCCGCATTAATGCAACTATGGGTTTAAGTGCAAACTTCGCCGCATGGTTCAGCGTTGCGGTGCTAGACTACCAACAGAAGTCTGAGGCTAACAGCCACGACGGACAAATTCGCGCCCATGGAGTAACAGGCCGTCTCCAGAATGGCGTACCATCGCTTTGTCCTGTAGTGGTCGCTGGACTGAACGGTGTGTCGAGAAGAATGATAGTTGACATAAGTGGACTGAGTTTCACGGGACACCTCTTATTCGGCTCCCACATCCAGTGCTTGTACACTTGCTGGCGTAGTATGCTGGGGCGTCGGAATGTTGCGCACGAAGTAGCTGGCTGCGACATACGTAAAATATCGCCACGGGGCACAACGCGGTCTTGGGCAGTCCAGACCTGCGACGTTCAGATTGGATGGCCGTTTGACGCGGTTCTGCGCAAAGTGCGACAGCCACTGAAACATGCCACATGTATTCTATCCCTCGGATGGGCAAGGCTAATGCTAGACCGATCGAACGGCAATATTGTACCATTGAGTCCTAAGCCACGCTGGCTGGCGAATTGCCAGTTCACAGATTGGTGGAAACCAATACTGAATGCACCGGTATCTAGGATCAGGAGGACTAAGATTATCCAGGTCTCATCGTCGGATACGCAATTAACAGATGAATATGGCGATTTAGGTCCGACCACGTGTATTTACCAAGTTAAGAGAACCCCTCTATCCATTTGTCTTTGGTCTTTACTGTCAGAGTTATTCCACTGTTTTAGGAAGCGTAGCCCCATAGAACTTTTTCGCATGCCTACCATCGCTATCAAAGGCATAAAACCGATGTTTAGCTTCATAACACAGTGTAATGACTTTAACTTCGGGTGGAATCCAAGAGTTCATGACTCGCCTATGAACTCTCGCGTCGGACCTGAACAGTGCCGCCGCAAGACGCAGCCTAGGCGCACCAGGACCGAACAGGACTTAGTAGTCGCTTCTGTGATCGCCGGATGTGGCGATTCTAGGAGTGAAGCAATATACCGCGGATCGCCTTCGCTGAGTCACCTTGCGCATTCGAGTTGTGCTCTACTTTATCACACTTTGACGGCTAAACCCAACGCGCGGCCAGCAACGCGCCCTACGCCGGCCGGCATGTATCGCAGTTCTAAGTCCTCGGATCGCGATCAGGCATGGATGACTGGCGCACAAGTTTCGCGTGATATCGTCACACTGTGGTTTCACTCAGTGATGGAGTGCGGAACTTTTCCCCTTCCATTTAAGGCAGCAATATGCAGCGATTCCGTAGTGGCTAAAGTACTGCGTAGTTGGTCCTCTATATGTACCAAGGTCGCCAGAAGTTTATCAAACGCAAACATAAGGACGGTATGCTACGAGGACAATGATCGGGAAGACCAAGTAGGGTGGGGGACTGGGCCTGAAGTATGCTCCGCCATTCCGCCAGGCCCTTACCATAGAGGTAACTGGATCGCAAGTGGCTCAGGGGATGGACATCATAATGAGAATACAGCCGTGACTCATAATGGTCGCAGACATTGGTTATCAAAACGGTTGGCGAGTACCAAACGGATCATCAAGTTTCCCACAGTTAACTTACGTCCGTCCCCCGTTAAGGCAGAATATGTTTGCCAAAACACCGATTGTGCACTGAGCTACTGTACGACTATCTACACTTTCTGTCCAACATGTTTGGGAAGCATTATACAAGCACACGGCATGACCCTATTAACAGAG"

print(nucleotide_sequence_ref==nucleotide_sequence)

plot_sorted_stacked_codon_distribution(nucleotide_sequence_ref, nucleotide_sequence)