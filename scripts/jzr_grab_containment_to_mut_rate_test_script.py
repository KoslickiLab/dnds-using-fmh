from dnds import *
from helperfuncs import *
import string
import random
from matplotlib import pyplot as plt
import pandas as pd

if __name__ == "__main__":
    k = 7
    scale_factor = 1

    mahmudur_nt_containment_list = []
    mahmudur_prot_containment_list = []

    nt_df=pd.read_csv('/data/jzr5814/sourmash_dnds_estimation/tests/results/dnds_ground_truth/p_mutation_rate_0.1_iteration100_random_10000_nt_sequence_modified_PdS_equation/nt_containment.csv')
    nt_containment_list = nt_df['containment'].tolist()
    nt_containment_list.pop(0)

    prot_df=pd.read_csv('/data/jzr5814/sourmash_dnds_estimation/tests/results/dnds_ground_truth/p_mutation_rate_0.1_iteration100_random_10000_nt_sequence_modified_PdS_equation/prot_containment.csv')
    prot_containment_list = prot_df['containment'].tolist()
    prot_containment_list.pop(0)


    dna_seq1 = 'CAGGTGGTGTCTTTCTTTGAGGCTAGAGAGGGTACGGGGCTCGAACTCTCGTGTTTTCCCTCCACGTCCACTATTACCTTATTTTGCGCTAGACACCGTTCGCGAACGTCCGCTAATCCCGGTACGTAAGGCGCGACGTGGTTGTAACTGCGGGAGTATGACTCGGACGGGTCGAAGCCTCCAACCTAGCTCGCATTCTATCAAGATCCATCGCTGCCCAACGGGTCCAGTGACATAGCTCACCCTAATAAGGGCATTCCACTGTATAGGAGCTAGCAACTATACGCCCTACGGGTTGGAAGTCTGATTCTATCTTCACATAAGCGGTATTGGTCTTTTGACGGCAGAACTGTTAGTATGCACGCAGTGTCGTAAGCGTCAGGCCTTATGTTTAACATCAACATCTCACGCGCCTGGCACCGTTCGTTGCAGACTGATCTCCAGATACCTGTTGCAGGTTACTATGCCGCGCTCAGATGGGAAAGCTCACATAAGGGGTTTCCGGAATTCTAAATGTTACTGAAATGCTCCATGCTTTTCTTCTTTTTTATAGTTGTGGCCGAGCAACTGGTTCACTTGTGGTCGTGCGGGTTTATGGACCTGTGTTAGCTTTTCGAATAGCAGAATGTTCTGCGCATGGTCCATCGTTGAACGCAGTTCGTGCCGCTGGCGAGTTCCAAGTTTGTAAGTTGGAAAAGTTAATCCGAAACCCCTTTAATAACTAAAGTTCATAAGCCCTAACGGGCGCGCATATACTTTAGGTAGTCAAGACTAGATCCCGATTATAGGATTCGCGTTCAAGGCTCAGACAAACTAGAAAATAAATTCTAAATCCTTTCGGAGGCCATGCTTGTTTGAGCCGGACATGGCTTTGGTCTCTCTTGAGGCGGCTTCAGGACAACGGCAAGTCTCTATCCCTAAACAGATTAGATCGCAGATATTGTGCGGTGTGCGCCGTAGGTCTCCCCGGTAGAGTGCCTACGACGTACTCCGGTAGCTTGGCGGAACGCCCAAGGGCTTAACGTACACTCGCTACTGTAACGATGTGGTAACGTGGAGGCCCAGTGATCCAAAGACCGTCCCTATCATCAAGTCCTTGTCAGACGTCATGAATAGCCCAGGGTCGTTAAGCCCCGCCATGACCTTGGGAAATCGATCAGCTCGCTTGTACTAGAGGAGACACGCATTCGTGTAAAGAGACCATATTCGCACTGCCCAACTGATAAAAACAGAATAGTGATTAGGGAAGTTACCCCAGTCGATGTGAACAGAGAAGTGCTGAATGGTCTTTAGCCCATCGTAACAGTAGCGTACGACGCCACCCCAATCCACCTGGCAATCCGCCAGTTAAGTACACACGCCGCCCTTTAGAAACTTAAACTGTGACCGCGCAGAGATCCTAGACTAATTCTGGTCCAGGATCCCTTACTTTGGAGAAGGGCGTTTGCTCCTCTTGCGGGATTCCGGAACCGGCTGCTTACTTCAGCACCCTGACGATTGTTTAGTCGCACGGGAGGCCCTCACGTTACTACTTGACGCATTACCCTTTACTCAAAGAGGGCTATTGACCTGAGTGGGAAATCTCGGCCCGGGATGCGCCTACAAGGGCGAGACGCTGCTCCTGTACATTGGGTCTGACCTATGCAAGATTCCACACCTACCTCCTGGTACAATAGTCACCACAGGAACAGAAACTTGAATGCGTCTATTCGGTATTCGTGCGTTTTGGGTTTCGCTCGGCGCTGAGCACCTGAAGGTTCGGTTCACATCATGTGGTTAGTATGACCGGTGACGTATTCTACATGAGGCACTCACGAGCCATCCTCTTACGGGAAGTAGGACTGGTTAATCGCTACTTGCTCACTTAGGGTCGTTCTAAACATCCACGTCGACCATAATAAATCACGCGACTGATGAAATCGTCAACCTTATCTGCGGGAATGTTAAGCACATAAACCCCGCAGTTCGACCAGTTGCTGGTGACCAAGGTTCCGGTTACGGACCCTTCGCTACGTAGATCGAGGTCTTCCGCCGTTTGATACCCCATTGTCCCGCCGGGCAGAGATGGGTCAATACGAGTAAAGACTTCTGGTTCCATCTCAAGCGGTCCATAATATAGGATGGGCCAGCATCCTCATCAAGGTTGCACAGGTGTTACTGGTCACCGAGCTGGGCTCTTGAAAAGGTGTCTCTGATGGTGCGCACCACAGGCCAGACGCGGCAACCATCAACGAGTTACAAGTCAACAGGCACCGGGCGATTGCGGGGCGCAGTCTTATGAGCGGATCCCGACCGTTCACGCAGCAAAGGGAAGACGGGCTGACGCTTTAACAAACTGTTTCGTATTTACTCTGCACATCTTGGTATGAATACTAACCAAACTTCTGAACCAGCTTAGCCGTGCGTACACGCGGGCCGCCTGGATTTACTAATATGCAGGAGCGATACTGGAAACCCTGCCTGGAGTTCTGGTTTTCAGTGCTGGATCCCAATCATCGGGATGACTCGGTTAAGAGGAGCACGTAGGCACGTGGGATCCTGCCCAGATTCCTATGATGTGATTAGAAACTCACCGGCCTAGAATAAGATTGGCGGCGGTAACGCGTAGCTACCGTTGTGCAATACTCCGGGAGGGCCCTCTAGGCGCAATGCTGCCCCTTTCAAGATCCTCGCATAGGGTTAATTCCTAGTTGCGTTTGTTTGCGCAAAACCTCTACACGGTATGAGGTCCATAAGATTGTTATCAATAAGCTGGTCGTCATTCACGCCTCAACTGGCATCCTTGCAGATAAGGCTTATGCTAACGCACGAATTAGGGTCTTAGATGGCCGCGTCCCGAACACTTAGTAACGTTCTACGCCAACCGCATCAGCGAGATAAGCTTTCACCCCGCAACAGGACGTAGGATCGTTAAGACTGCGTGAATCAAGAGACCCGCATAGGATAACTCCGAACACTCGCACCCATAGACGACGTCGAGTGGTACCACGTTTTTCCTATTATAGGCCGTAGCAACAAGGCGTCGACTCTGGTAACAGCTCCTGTCACGGAGCCCGGATGTATAACGAGCGGGAAGTGTCTGCAAGAAGCAAATAACTCGGGATTTCTATAGCAAACTAAAAATCTTGACGAGAAATGGAGGATGAAAATGCAGTCGGGCCTGTTTAATGAAGGGGCTCCCAACTTTGTTAGGGTATCGTGATCCATAGGCATCCAAAAGAGAACAACTGCATCCGATCGAGGTTTAAGGAGCTGCCCTCACCACCAGTCGTCCTAATAGCGGACTGCGAATACAAACCAGCCTAACCCTGTGGGCTGTTGTAGCAGCTACATGGGAATTCGCTATTGGAAGCTATAGTATGCTGGGCACACCCGCCATCGCCTATTGCAGTAATATCTTCACACGTTAACGGTCGAGGGGTACACGAGAGTTAGGTGAACCCTTCGGATTGTGGTGGTATGAGGCTAGCGGGTGAGAAATTATCCTAAAACTGTAGCCTAATTTGGCCAACTGAAGGAATAAATTTGCCGGCAGTACAACGACTCCGATGGCTCGACCCAAACACCAAGATTCCGTACACTGTTGCTGTCCATCCTGCGCGTATAATTAATTGGCGGTCACTGCTACTCTGTTTAGGCAAGTCTGAACAGGGTACGATGGTCATTTTCTGGGGTCTGATGGCTTGCGCTTCAGGTCCGCGGACATGCCTCTACCCGCAAGCCCCGTCGGATTCAGGGGTACTACCGGACTCACGGGGTAAACCATGCGGTGTTGCGGACTGCGCACGATTGATCTATTATGTGAAGGGTGGACGTTGCTCATTTCATCACTGGTATAAGGCAACTGTCAAAGAGAAGTCCCGAAGCGTAGGGAGAATCTATTTGATGCTACCAGCGCAAGTAACGTAGGGATTCTTTGTGAGACGAGTGACACCCAGGGTGGCCGTCTTCTACAAGCTAGAAGCCCGCGTTAACGTCCAAGCATGGCAGTCGCCGGTGTTTAGTTTGATACAAGGCCACAGTAGCCCTAAATGGCCTGGGACACGCCCCACGATCCCCCTCGTCATTCAACACGCGCAGCAGCGATTCCAGTTTCCATATTGTGATAGCTGAAACGATAGCAGCAGGTCGGGACTAAATGCGCAACCTGAGAGGTGATCCTGTGAAGTGAACCGCGACCTTTAAGTGTGTGCAGACGGGCATGGTACGAGTTACCGCGCTTGCAGAACAATTGCCATCAGCAAACTGGAACTGTGTCCAGCCCACAAGGTAGGAGGTCAGGGACGTGTGTTTCAATGGATCGGGCGGGTTCCTCCACACTTCGACAACCAGGACGGTCAATATAGGGGGCGAGTACTATGGGGAAAACTCAGGGTACTTATCGTGCGGGATGTAAGACCTGTGATCTTGCATATAGCCAAGGCGGTCTAGGCGTCACGTCTATGCGTCCATTCTTGAACACCCCTGATAGAAGTCCTAGTGCACTACAGAGAAAGAGGAAGAGATGGATGAAGCTATCTGAAATGAACAAGTCCGCTCTAGAAGAAACCTTCGGCGCCCGACACCGGAAATGGGACAATATAGATGTATGAATCTAAACGAGAGGTCTTGGCGTCCTTTAGGAAACTGTGTGCATCTTCGTGTTACTGTATTTGGAGTCAGGTAATAAAACGCACACATACCCGTGCCGCAGTTTTCGCACTCGTCATAAGATAACACTATTTAGTTAGGCCAATCTCGGACCTTCACACTTCACTTTTAACATACTGTCTTAAATACACCAACTTGTAAGCCTCACCCTGGGGACCGTTGGGTCCAGAAATGACTTGTTGCCCGTATAGTATAACTTATCCCCCGCTCTCCATCAATGCAGGGGTGATTGGTCTAACTTCAAATGCTGAGATACGCCTGTCGTCTGTATTCTTGTTTTCTACTCTAAAAGTTATCCACAAAGCTGAACTTATTAATTTTCGTGGATGTGATAGGCTAATAGGATTAATGACACTAGGCTTTCAGGGTAGCTACGGTGTTAGAGTCTGCTACCGGGAGGAAGGGGTGAATGTGTTCTCGGCTGAGCTAAAATATCCTAGCTTGGATTACCCGAATGTGACTAGTGCTGCTCGTTAGTTGAGGCTTTATGTATATGGGTGAAGACTTTCCCCAGAACCATGGAGTTTAAAATCGTTACCAGTCGTCAGTACACCGGCCAAGGTAATTTTCGTGGGGAGGGTGTCCGGCGCGAAACAACTCCAACTGCTTCGAAATGCAAATCGGCCTCAAAGATATGGCGATAATACGCGATGGGCAGTCAAGACAGGTCTGGTATTTCCCGGGCGATTGCACTGGTTGTATCGGATCTCAACACACCCAGACAAAAGTCTCGAAAAGACGATCTCTTCGGCTCTCACCAGATGCTCACGCCCTACTGGGCAAAATATAGGCGTGGCAGTTTGCATCAGGCGCATATCCGACCAGCGCTCGTTTAGGCACAGCTCTAAAGACTTGCTGACAGGATGGTCGGAAGTGGGTCACTGCCCGGTTGAATCGTATTCACAAATGATGGCTCTCGGACGTGGATTAGACGGACGTCTCTGCCTCGGCGGGACGTGCTAGGGGGAAACATCGCGAGGCTCATGAATGAACAAAGCCAAACCTAACGTTCTGAAACCGACTCTGGGTATTGCTTAGCTGGATAATGCAGCGAATTCCGGACTCCTGGTGGTTCCGGGTAATTCGACTATAGTTAAAATAGCTCATACATGACTCGAACTCGTCGTGTCATGGTGAGCCTACGGGCCTAACCGTTGATTACTTCCGAGTATTGGTGGATCCGAGTATGGCCCATGTTGAATCGATCCCACGTCGGACAACACGCAGTAAGCTACCAGACTGTTCCGCGATGGCGGACGAGCTATAAGTAGCCACTGGAGAACCCAACAAGCACAGTGTCTCGCGGCCCGCCGCTGATCTGAACTTGATCGTGTAGCACTCTTGCTAACACAGATCACCCTGTACCGGAAGGAATTATAGGAGTGGACCCGTAGACTCGAGCCGAGGTCCTATTACCGGTAAAACATTGTCCACTGCATTGGCGGATTTTACCCTCGCGTTTTGGTTAGACTTGATGGTATCAATACGGACCGGACGATGAACGCGGAGGGTGCACCTTGGGCTGACCACTACCACGGGACGCAGCTTCAGAGATGAGGGAAAGTACAGAGATTTAACCGCGTAGTTTCGGTCAACTGGGTAGAATGTTAGTAGAATGCTTATTACCCTAGGGTGGGACAAGTAGGGCTTGAAGTTTAAACGCTGGCCGCCATGGGATTCCGGACTCGAATCAGGACATCGGCCGTCCGAGGCGTCCTCCCAGTAGACGGGGTGACTGTCGATTGCCGGGGCGGCCTACAATTACTTTCCAGTGAAAGCGTTCTTAGCCAGACTTGAGGCGCGCATAAGTTAGTCAACAATACCCCCCGCATAGTATAGGCGAAGCCGGTAAGGCCTCCTCGTGCAGTGGAAAGGGTATAAGCACTGTGGCCCGGGGCCTCGAGGGCAGGTGAGATTTATGCCTTCCGAGGCGTCCCCAAAAGACCTGAACAAAAGCTGCTCGGACTCGTGATCCAACAAGTGTCTACGTTCGGACCGAAGTGATTACGACCTAGAGTATTATCAAACCGTATTGATTCAGGTGTAAACGTGCGGACACACTTAAGTAGTTCTTACTCGCCGCTCAAGATAGTTCACCTTAACTAGTTCCAACGTGCTATAGGAAAAATAATCCTTTCCAGGATCTCGTTACCGTCGGGTAATGGCTACGGACACCGGGCCATCCGGCCAGAGAACTCAATGAGTCATAGGCAGAATCGAGAGATGGGCGCCTTACTGTCTTGTTAATCGGGGGGAATACCACCACCAGAGTCACAGAAAAGTATTGGACGCGCGGGCCATTTATCAAAGGTAAGCACTCCAGATCAGCTCACCCTTAGATCCCCCGACTAGTCGGAATGGTGGGATGCAATACTATGCTCGCTCACGATCCCAAGAGACGCATTGGGCGTACGGCTCGAAGGTGCATGAAGCTGGCCTGCATGGACGAAACATGAGACTCGTGTGCGATTACAGTTGTGGACGTTGAGACGTGGTTGACCTCCTATCCGTTTGAATTTTTTGGCGGTTTTACATAGAGCGGCCGCGTGTGGCTCGCAGGTGGTATATGCGCCGTTGCCGGCAACTCTAACTGTGTATGAGCAAAATGACTACCTGAGTGCCGTCTGAGTTCTTTGGATGTCAGCCAACAAGCGAGTTTACGGCGGAAAACGTGTATCGTAGCCATTGCCTAGGTCCGCCAGCTGTGCACGAGTTGTATCTTGACCTGCTCATTGGTCCACGAAGAAACATCGAACTAAGGCATCTTACACTCCACTCGTTAGTGCCGTTGAGTACCACCTGTCGGGTGAAAGGTGAAAAAGGGCGAGCGCGCAAAACATGGAATGTGGATGAGATGGATAGTCAAATAGACTCAGCAGTAGGTCGCCACATTGTTCAGCAACTCATCGTCCACGGCGTTCGGCCTACGAAGTGCATAACCACGTAGCCGCATACCTGGGATCGTCAGGGGTCAGTACTTAGGTTGGTAGACACCCTGAGATGCTTCCGCGGCATTCCTTCTGGCAGGATAGATTCGAGTTATGCTAATATGTGCACTGTCGAATCTCCCCGAGTGTACTCGCGTGGTGACTAACCGAACACGTGCATCACTTGAGAGCGCTTAGGGCGACCCCTTGTACGGTGGTCAGGCTCCTTATTAGTTAGCAAAAACTTTTCCTGCCCGCACGGATACTAGTTCTCCAAACATGGCCGTTTGTTGGACACTTATTTGAGGTAACTTCCCCGCTGGCGGTCCGCCCACCGCACAACGTGCTTGGAAGGGCAGTACTGGTGAACTGAAACTGGGTGGACGAGCATGTGTCGCAGAACTAGCCTGTCCTGGACTTTACCTCGCGCATATTGGCTCCAGCTTTGACGTGGTTATTTGTCCTGCTGGGGAAGGAGCTCCTCGCTCACCAGCCGGTCAGTGCGGTTGAAATGCTATTGCCTTCAGCGTTTTAGTGAATAGGGGTAGTAAATTTTGTCCTTATCAATTTGGACCACTGGGGAAGATCTGTTGCGGTACGGTTCAGCTCAGTACTGGAACTCAGCGATTGCACCCTATCCCTTAGTAATTGTGTACCGCGACTTGCAGCGTTCTAGCACTTACGTGACTCCCCCCCCTCCCGTTTGACATCTTTGCTATGCACGTATAAGCTAGGCTACCTAAGAGTGTAACCGTGAGGTACTCGTAGAAGGGCTGATTCGGGCAGAACGTGTAGATCGGGTACCTGCCAGTCAGAACTGTCTTCACACCCCTCTTCATCAGAGCTGGGTGAAACCGCAAGGAAATATCTACAATGTAACTCTAGGATCTTTTTACGTGGTGTACTTACATGACCCATACTCGTTGCATATCTCTTCGCACGCATTAGATCGCACACGAGATCCTGGTTGCTAGCTATCCAGTCTGCTAGGTTCTGAACATTAGTCGCTTTTGATGACAGGTCCTTAGCCTTTACAGTGACAAGGCGCGATATTCTCCGCGGATACAGTGTAGATATGACAATTGAAGAATGCGCTGTCATTATGACTTAGTTTTACTAGCATGTGGGGGACCGGTGAAGGAGAGGTTGAATGCCTGGCCGCACCTAGATTGAGGACGAAATTCCCAGACTTTTACAACTGCCTTGGGTTACGCGCGCTAATGCTGTAGATGGGCTTTCCATCTCTTCGATGCGTCTCAGTCGACCCATCGGTACTAAAGAGATCTTGAGCGAGCGCCATGCCTATATCGTGCGATGCAGATGAGAGTGACCTCTAACATTCCTATTGGCGATGTCGAAGTTACCCGATATTTTAACTACACCGTACAGAGCGGGTCCTGTTTGCTAAATTATACACGGGATGACTTTATGATGCGAATGCTATATATGGACCTAGGGGATAGTAGGGATAGGTCGTCATAGGCTCTTATGATGACTCGTTGGTCCTATAGACTAGAGCAAGTGCGCCTCGTGCCATTCATTTGCCCACGCCCAGCGTGTCGAGCTAGTTGGAGTTCAAGTGCTAGAAAGTTGCACAAACGCGCCATATTTTTTTCTAAAGCGAAATAAATAAGTACTTGAACAGAGAGTATTGGGTGGACACGTAGGGTCCGGAATGAGGTGCGGTAGTCAACGAGTCGGGGCATCTTCAATACTGCTGGTAGCTTTCTTATTTAACGCCTCATTATCGATCTCTTGTTCGGTAAGCAGTCTAATATTACACTGACAGCAATCCTACGCGCGTTTGGAATGACCCTATGGGCACCCGGCTATTTCATGCGTGATCGCAGGGGTCTAAATATTGTAAATCCGAGTCGCCAGAAATGGCTCAGACAGGCTATCACTTTATGTAGTGTCAATCGGGACTATATCCGCACTCTGGCGCTGTTCCAGTGGAATAGCATGCCCAGAGATAAGATGTGCGTACGCTCGATGCTTATGACTTACAGGTAGACATGCCATCTAGTTCTAGGCACTTACGCCGGCCGTAGATTGCATTGGCTGGAACTGGGGACTTCATGAGCGCTTCACTCATGCAAGGCCTGTAGCTGGGCTGGCTTCTAGCAGGGCTTTGGGCTTCAAGGCCCACCATTGCCCGCTCTACTTCGTGCCCTCTAATCTGAATACTTAAAATGGTCGGCCACACGAGGGCTTGAAGCAAATTTGTAAGGATATCCACGGGACTGGACACGAGGTCCGTTTGCAGTGTAGGTAGCCAACAGTTACCTGAGTGGGTTGAGGTTGACACGAGGCTGATAGGACAGCCCGCTCATCATTGGGACCATACGTTGTCGCTGCATGATGGCAATCGTCTAATACCAAATATTTAGCACCCAAATTGGCCCTCTGCAGCCAGC'

    lines=open('/data/jzr5814/sourmash_dnds_estimation/tests/results/dnds_ground_truth/p_mutation_rate_0.1_iteration100_random_10000_nt_sequence_modified_PdS_equation/10000_nt_mutated_queries_seq.fna','r').readlines()

    for dna_seq2 in lines:
        if dna_seq2[0] != ">":
            aa_k = k
            nt_k = 3*k
            nt_containment = sequences_to_containment_using_fmh(dna_seq1, dna_seq2, nt_k, scale_factor)
            aa_containemnt = sequences_to_containment_using_fmh( translate_dna_to_aa(dna_seq1), translate_dna_to_aa(dna_seq2), aa_k, scale_factor)

            mahmudur_nt_containment_list.append(nt_containment)
            mahmudur_prot_containment_list.append(aa_containemnt)

containments=pd.DataFrame(list(zip(mahmudur_nt_containment_list, mahmudur_prot_containment_list, nt_containment_list, prot_containment_list)),
               columns =['mahmudur_p_nt', 'mahmudur_p_aa','jzr_p_nt','jzr_p_aa'])

containments.to_csv('/data/jzr5814/sourmash_dnds_estimation/tests/results/dnds_ground_truth/p_mutation_rate_0.1_iteration100_random_10000_nt_sequence_modified_PdS_equation/containment_comparisons.csv')
